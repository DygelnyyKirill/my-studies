"use strict";const formBox=document.querySelector(".form-box1"),formLogin=document.getElementById("login"),formRegist=document.getElementById("register"),message={loading:"img/load.gif"},statusMessage=document.createElement("img");statusMessage.src=message.loading,statusMessage.className="load-form";const formSend=(e,t)=>o=>{o.preventDefault();const s=formValidate(e),n="http://localhost:3000/auth/"+t;if(0===s){e.append(statusMessage);const t={email:e.querySelector('input[name="email"]').value,password:e.querySelector('input[name="password"]').value};console.log(t),(async(e,t)=>{const o=await fetch(e,{method:"POST",body:t,headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error;return await o.json()})(n,JSON.stringify(t)).then(e=>{localStorage.setItem("token",e.token),console.log(e),showModal(!0)}).catch(()=>{showModal(!1),console.log("error")}).finally(()=>{e.reset(),statusMessage.remove()})}else console.log("This is a required field.")};function formValidate(e){let t=0,o=e.querySelector("._email"),s=e.querySelector("._password");return[o,s].forEach(e=>fieldRemoveError(e)),validateEmail(o)&&(fieldAddError(o),t++),""===s.value&&(fieldAddError(s),t++),t}function fieldAddError(e){e.parentElement.classList.add("_error"),e.classList.add("_error"),console.log("This is a required field.")}function fieldRemoveError(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error"),console.log("ok")}function validateEmail(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}function isValid(e){return e.lenght>=5}formLogin.addEventListener("submit",formSend(formLogin,"login")),formRegist.addEventListener("submit",formSend(formRegist,"register"));const modal=document.querySelector(".modal"),contentModal=document.querySelector(".text-content");function showModal(e){modal.style.display="flex";const t=`\n        <div class="text-content"> \n            Login was ${e?"successful":"unsuccessful"}\n        </div>\n    `;contentModal.innerHTML=t,setTimeout(()=>{modal.style.display="none"},1500)}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("login"),t=document.getElementById("register"),o=document.getElementById("log-btn"),s=document.getElementById("reg-btn"),n=document.getElementById("btn");s.addEventListener("click",(function(){e.style.left="-400px",t.style.left="50px",n.style.left="110px"})),o.addEventListener("click",(function(){e.style.left="50px",t.style.left="450px",n.style.left="0px"}))}));const addMessage=document.querySelector(".message"),addBtnTodo=document.querySelector(".add-Todo"),addBtnServer=document.querySelector(".add-Server"),todo=document.querySelector(".todo");let todoList=[],serverList=[];function getResource(e){fetch("http://localhost:3000/to-dos/605110eae5e3d06785c076ac",{headers:{Authorization:"Bearer "+e}}).then(e=>e.json()).then(e=>{serverList=e,todoList=e.todo[0].listItems,console.log("res",serverList),displayMessages()}).catch(e=>{console.log("error",e)}).finally(()=>{addMessage.value=""})}function updateDataTodo(e){serverList.todo[0].listItems=todoList,console.log("ServList",serverList.todo[0]),fetch("http://localhost:3000/to-dos/"+serverList.todo[0]._id,{method:"PUT",body:JSON.stringify(serverList.todo[0]),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{console.log(e),displayMessages()}).catch(e=>{console.log("error",e)}).finally(()=>{statusMessage.remove()})}function displayMessages(){let e="";todoList.forEach((function(t,o){e+=`\n        <li>\n            <input type="checkbox" id="item_${o}" ${t.isCompleted?"checked":""}>\n            <label for="item_${o}" class="${t.important?"important":""}">${t.title}</label>\n            <button id="${o}" class="trash-btn">X</button>\n        </li>\n        `,todo.innerHTML=e}))}getResource(localStorage.getItem("token")),addBtnTodo.addEventListener("click",(function(){if(""!=addMessage.value){const e={title:addMessage.value,isCompleted:!1,important:!1};todoList.push(e),localStorage.setItem("todo",JSON.stringify(todoList)),displayMessages(),addMessage.value=""}else alert("Enter the tasks")})),addBtnServer.addEventListener("click",(function(){updateDataTodo(),alert("Tasks have been successfully sent to the server")})),localStorage.getItem("todo")&&(todoList=JSON.parse(localStorage.getItem("todo")),displayMessages()),todo.addEventListener("change",(function(e){const t=todo.querySelector("[for="+e.target.getAttribute("id")+"]").innerHTML;todoList.forEach((function(e){e.title===t&&(e.isCompleted=!e.isCompleted,localStorage.setItem("todo",JSON.stringify(todoList)))})),console.log("valueLabel:",t)})),todo.addEventListener("click",(function(e){if("trash-btn"===e.target.classList[0]){const t=e.target.getAttribute("id");todoList.splice(t,1)}})),todo.addEventListener("click",(function(e){const t=e.target;if("trash-btn"===t.classList[0]){t.parentElement.remove(),localStorage.setItem("todo",JSON.stringify(todoList))}}));